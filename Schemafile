# frozen_string_literal: true

create_table 'users', comment: 'ユーザー'  do |t|
  t.string :username, null: false, comment: 'ユーザー名'
  t.string :first_name, null: false, comment: '姓'
  t.string :last_name, null: false, comment: '名'
  t.integer :phone_number, null: false, comment: '電話番号'
  t.string :email, null: false, comment: 'メールアドレス'

  t.timestamps null: false

  t.index :username, unique: true
end

create_table 'accounts', comment: '口座'  do |t|
  t.references :user, null: false, foreign_key: { to_table: :users }
  t.decimal :balance, null: false, comment: '残高', default: 0.0
  t.string :account_number, null: false, index: true, comment: '口座番号'
  t.string :branch_code, null: false, comment: '支店コード'
  t.string :branch_name, null: false, comment: '支店名'

  t.timestamps null: false
end

create_table 'wallets', comment: 'ウォレット'  do |t|
  t.references :user, null: false, foreign_key: { to_table: :users }
  t.string :glueby_wallet_id, null: false, comment: 'ウォレットID'

  t.timestamps null: false
end

create_table 'tokens', comment: 'トークン'  do |t|
  t.string :payload, null: false, comment: 'トークンペイロード'

  t.timestamps null: false
end

create_table 'funds_transactions', comment: '資金の流れを追うモデル'  do |t|
  t.references :source, polymorphic: true
  t.references :target, polymorphic: true
  t.integer :transaction_type, null: false, comment: 'TODO:'
  t.datetime :transaction_time, null: false, comment: '取引日時'

  t.timestamps null: false
end

create_table 'account_transactions', comment: '口座入出金履歴'  do |t|
  t.references :account, null: false, foreign_key: { to_table: :accounts }
  t.decimal :amount, null: false, comment: '金額'
  t.integer :transaction_type, null: false, comment: '0: 入金, 1: 出金, 2: 口座振替'
  t.datetime :transaction_time, null: false, comment: '取引日時'

  t.timestamps null: false
end

create_table 'wallet_transactions', comment: 'ウォレット入出金履歴'  do |t|
  t.references :wallet, null: false, foreign_key: { to_table: :wallets }
  t.decimal :amount, null: false, comment: '金額'
  t.integer :transaction_type, null: false, comment: '0: 入金, 1: 出金, 2: 送金'
  t.datetime :transaction_time, null: false, comment: '取引日時'

  t.timestamps null: false
end

create_table 'token_transactions', comment: 'トークン生成履歴'  do |t|
  t.references :token, null: false, foreign_key: { to_table: :tokens }
  t.decimal :amount, null: false, comment: '金額'
  t.string :tapyrus_transaction_payload, null: false, comment: 'Tapyrusトランザクションのハッシュ'
  t.integer :transaction_type, null: false, comment: '0: 発行, 1: 焼却'
  t.datetime :transaction_time, null: false, comment: '取引日時'

  t.timestamps null: false
end

create_table "glueby_keys", force: :cascade do |t|
    t.string "private_key"
    t.string "public_key"
    t.string "script_pubkey"
    t.string "label"
    t.integer "purpose"
    t.integer "wallet_id"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["label"], name: "index_glueby_keys_on_label"
    t.index ["private_key"], name: "index_glueby_keys_on_private_key", unique: true
    t.index ["script_pubkey"], name: "index_glueby_keys_on_script_pubkey", unique: true
    t.index ["wallet_id"], name: "index_glueby_keys_on_wallet_id"
  end

  create_table "glueby_system_informations", force: :cascade do |t|
    t.string "info_key"
    t.string "info_value"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["info_key"], name: "index_glueby_system_informations_on_info_key", unique: true
  end

  create_table "glueby_utxos", force: :cascade do |t|
    t.string "txid"
    t.integer "index"
    t.bigint "value"
    t.string "script_pubkey"
    t.string "label"
    t.integer "status"
    t.integer "key_id"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["key_id"], name: "index_glueby_utxos_on_key_id"
    t.index ["label"], name: "index_glueby_utxos_on_label"
    t.index ["txid", "index"], name: "index_glueby_utxos_on_txid_and_index", unique: true
  end

  create_table "glueby_wallets", force: :cascade do |t|
    t.string "wallet_id"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["wallet_id"], name: "index_glueby_wallets_on_wallet_id", unique: true
  end

  create_table "glueby_reissuable_tokens", force: :cascade do |t|
    t.string "color_id", null: false
    t.string "script_pubkey", null: false
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["color_id"], name: "index_glueby_reissuable_tokens_on_color_id", unique: true
  end

  create_table "glueby_timestamps", force: :cascade do |t|
    t.string "txid"
    t.integer "status"
    t.string "content_hash"
    t.string "prefix"
    t.string "wallet_id"
  end
